Sparse coherent version with sweep and single trained layer