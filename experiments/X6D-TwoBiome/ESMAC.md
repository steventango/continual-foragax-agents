Sparse coherent version with sweep and three trained layer